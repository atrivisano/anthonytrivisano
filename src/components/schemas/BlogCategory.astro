---
import { siteMetadata, getCanonicalURL } from '../../utils/siteMetadata';

interface Props {
    name: string;
    url: string;
    description?: string;
    posts?: Array<{
        title: string;
        url: string;
    }>;
}

const {
    name,
    url,
    description = `${name} articles by ${siteMetadata.person.name}`,
    posts = []
} = Astro.props;

const collectionPageSchema = {
    "@context": "https://schema.org",
    "@type": "CollectionPage",
    "name": `${name} - ${siteMetadata.title}`,
    "description": description,
    "url": url,
    "author": {
        "@type": "Person",
        "name": siteMetadata.person.name
    },
    ...(posts.length > 0 && {
        "mainEntity": {
            "@type": "ItemList",
            "itemListElement": posts.map((post, index) => ({
                "@type": "ListItem",
                "position": index + 1,
                "url": post.url,
                "name": post.title
            }))
        }
    })
};
---

<script type="application/ld+json" set:html={JSON.stringify(collectionPageSchema)} />